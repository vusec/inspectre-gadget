SELECT transmitter, exploitable, COUNT(DISTINCT pc) FROM call_gadgets WHERE (exploitable != 'True' OR secret_address_control != 'ControlType.CONTROLLED') GROUP BY transmitter, exploitable
UNION ALL
SELECT transmitter, ' TOTAL ', COUNT(DISTINCT pc) FROM call_gadgets WHERE (exploitable != 'True' OR secret_address_control != 'ControlType.CONTROLLED')  GROUP BY transmitter
UNION ALL
SELECT transmitter, exploitable, COUNT(DISTINCT pc) FROM call_gadgets WHERE (exploitable != 'True' OR secret_address_control != 'ControlType.CONTROLLED') AND name IN (SELECT * FROM reachable) GROUP BY transmitter, exploitable
UNION ALL
SELECT transmitter, ' TOTAL ', COUNT(DISTINCT pc) FROM call_gadgets WHERE (exploitable != 'True' OR secret_address_control != 'ControlType.CONTROLLED') AND name IN (SELECT * FROM reachable) GROUP BY transmitter